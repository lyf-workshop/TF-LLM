# Word Puzzle Hierarchical Learning - Qwen2.5-7B-Instruct
# 与 KORGym 论文完全对齐的配置

defaults:
  - practice: base
  - agent: practice/word_puzzle_qwen_clean
  - eval: logic/easy_base_hierarchical_clean

exp_id: word_puzzle_qwen_hierarchical

# KORGym Game Settings (Paper Aligned)
korgym:
  enabled: true
  game_name: "8-word_puzzle"  # Word Problem
  game_host: "localhost"
  game_port: 8775
  level: 4  # 论文默认 level 4
  num_seeds: 50  # 论文使用 50 个不同的游戏实例
  max_rounds: 50  # 单回合游戏，此参数不影响

# Data configuration
data:
  practice_dataset_name: KORGym-WordPuzzle-Qwen-Train
  eval_dataset_name: KORGym-WordPuzzle-Qwen-Eval
  batch_size: 5  # 每批 5 个游戏
  num_epochs: 10  # 10 轮训练（50 个游戏总共）

# Evaluation settings
evaluation:
  data:
    dataset: KORGym-WordPuzzle-Qwen-Eval
    pass_k: 1

# Hierarchical learning settings
practice:
  hierarchical_learning:
    enabled: true
    l1_aggregation_threshold: 5   # 每 5 个 L0 → 1 个 L1
    l2_aggregation_threshold: 3   # 每 3 个 L1 → 1 个 L2
    max_l0_per_game: 1            # 每个游戏最多 1 个 L0
    max_l0_recent: 30             # Prompt 中保留最近 30 个 L0
    include_l0_in_prompt: true    # 在 Prompt 中包含 L0
    
    experience_save_path: workspace/hierarchical_experiences/word_puzzle_qwen.json
    agent_save_path: workspace/agents/word_puzzle_qwen_enhanced.yaml

# GRPO settings
group_size: 5   # 每组 5 个游戏
num_batches: 10 # 10 批（总共 50 个游戏）

# Agent settings override
agent:
  agent:
    name: word_puzzle_qwen_agent
    instructions: |
      You are an expert at solving word puzzles and crossword games.
      
      Analyze the game board and clues carefully:
      1. Read all clues for both horizontal and vertical entries
      2. Start with clues that seem most certain
      3. Use letter patterns and word lengths to deduce answers
      4. Cross-reference intersecting words to verify answers
      5. Consider common word patterns and vocabulary
      6. If you're uncertain about a word, use context from intersecting words
      
      Output Format:
      Your final answer MUST be a valid Python list of strings in this exact format:
      Answer: ["word1", "word2", "word3", ...]
      
      List all words in the order they appear in the clues (typically horizontal first, then vertical).
      Even if you're not sure about some words, provide your best guess for all positions.




